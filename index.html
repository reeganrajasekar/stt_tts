<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Speech to Text</title>
	<link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
	<nav class="navbar navbar-expand-lg sticky-top" style="background:white;box-shadow:1px 1px 2px #aaa;">
        <div class="container">
            <a class="navbar-brand" style="font-size:22px;font-weight:900;color:#2b74e2" href="">
                Speech to Text
            </a>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
					<li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/">Voice-to-Text</a>
                    </li>

					<li class="nav-item">
                        <a class="nav-link" aria-current="page" href="/voice.html">Text-to-Voice</a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>

	<div class="container my-4 words">
		<p id="p" class="border p-4 rounded" contenteditable style="font-size:18px;font-weight: 600;text-align: justify;color:#444">Try to speak</p>
	</div>

	<script>
		var speech = true;
		window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

		const recognition = new SpeechRecognition();
		recognition.interimResults = true;
		const words = document.querySelector('.words');
		words.appendChild(p);

		recognition.addEventListener('result', e => {
			const transcript = Array.from(e.results)
				.map(result => result[0])
				.map(result => result.transcript)
				.join('')

			document.getElementById("p").innerHTML = transcript;
		});
		
		if (speech == true) {
			recognition.start();
			recognition.addEventListener('end', recognition.start);
		}
	</script>
</body>

</html>
